!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.DraggablePolyline=e()}}(function(){return function e(n,t,r){function o(a,s){if(!t[a]){if(!n[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=t[a]={exports:{}};n[a][0].call(c.exports,function(e){var t=n[a][1][e];return o(t?t:e)},c,c.exports,e,n,t,r)}return t[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,n,t){"use strict";function r(e){return function(){return e}}var o=function(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(e){return e},n.exports=o},{}],2:[function(e,n,t){"use strict";function r(e,n,t,r,i,a,s,u){if(o(n),!e){var p;if(void 0===n)p=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[t,r,i,a,s,u],f=0;p=new Error(n.replace(/%s/g,function(){return c[f++]})),p.name="Invariant Violation"}throw p.framesToPop=1,p}}var o=function(e){};n.exports=r},{}],3:[function(e,n,t){"use strict";var r=e("./emptyFunction"),o=r;n.exports=o},{"./emptyFunction":1}],4:[function(e,n,t){"use strict";function r(e,n,t,r,o){}n.exports=r},{"./lib/ReactPropTypesSecret":8,"fbjs/lib/invariant":2,"fbjs/lib/warning":3}],5:[function(e,n,t){"use strict";var r=e("fbjs/lib/emptyFunction"),o=e("fbjs/lib/invariant"),i=e("./lib/ReactPropTypesSecret");n.exports=function(){function e(e,n,t,r,a,s){s!==i&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function n(){return e}e.isRequired=e;var t={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n};return t.checkPropTypes=r,t.PropTypes=t,t}},{"./lib/ReactPropTypesSecret":8,"fbjs/lib/emptyFunction":1,"fbjs/lib/invariant":2}],6:[function(e,n,t){"use strict";var r=e("fbjs/lib/emptyFunction"),o=e("fbjs/lib/invariant"),i=e("fbjs/lib/warning"),a=e("./lib/ReactPropTypesSecret"),s=e("./checkPropTypes");n.exports=function(e,n){function t(e){var n=e&&(x&&e[x]||e[j]);if("function"==typeof n)return n}function u(e,n){return e===n?0!==e||1/e===1/n:e!==e&&n!==n}function p(e){this.message=e,this.stack=""}function c(e){function t(t,r,i,s,u,c,f){if(s=s||A,c=c||i,f!==a)if(n)o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else;return null==r[i]?t?new p(null===r[i]?"The "+u+" `"+c+"` is marked as required "+("in `"+s+"`, but its value is `null`."):"The "+u+" `"+c+"` is marked as required in "+("`"+s+"`, but its value is `undefined`.")):null:e(r,i,s,u,c)}var r=t.bind(null,!1);return r.isRequired=t.bind(null,!0),r}function f(e){function n(n,t,r,o,i,a){var s=n[t],u=M(s);if(u!==e){var c=W(s);return new p("Invalid "+o+" `"+i+"` of type "+("`"+c+"` supplied to `"+r+"`, expected ")+("`"+e+"`."))}return null}return c(n)}function l(){return c(r.thatReturnsNull)}function y(e){function n(n,t,r,o,i){if("function"!=typeof e)return new p("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var s=n[t];if(!Array.isArray(s)){var u=M(s);return new p("Invalid "+o+" `"+i+"` of type "+("`"+u+"` supplied to `"+r+"`, expected an array."))}for(var c=0;c<s.length;c++){var f=e(s,c,r,o,i+"["+c+"]",a);if(f instanceof Error)return f}return null}return c(n)}function d(){function n(n,t,r,o,i){var a=n[t];if(!e(a)){var s=M(a);return new p("Invalid "+o+" `"+i+"` of type "+("`"+s+"` supplied to `"+r+"`, expected a single ReactElement."))}return null}return c(n)}function v(e){function n(n,t,r,o,i){if(!(n[t]instanceof e)){var a=e.name||A,s=T(n[t]);return new p("Invalid "+o+" `"+i+"` of type "+("`"+s+"` supplied to `"+r+"`, expected ")+("instance of `"+a+"`."))}return null}return c(n)}function h(e){function n(n,t,r,o,i){for(var a=n[t],s=0;s<e.length;s++)if(u(a,e[s]))return null;var c=JSON.stringify(e);return new p("Invalid "+o+" `"+i+"` of value `"+a+"` "+("supplied to `"+r+"`, expected one of "+c+"."))}return Array.isArray(e)?c(n):r.thatReturnsNull}function g(e){function n(n,t,r,o,i){if("function"!=typeof e)return new p("Property `"+i+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var s=n[t],u=M(s);if("object"!==u)return new p("Invalid "+o+" `"+i+"` of type "+("`"+u+"` supplied to `"+r+"`, expected an object."));for(var c in s)if(s.hasOwnProperty(c)){var f=e(s,c,r,o,i+"."+c,a);if(f instanceof Error)return f}return null}return c(n)}function w(e){function n(n,t,r,o,i){for(var s=0;s<e.length;s++){var u=e[s];if(null==u(n,t,r,o,i,a))return null}return new p("Invalid "+o+" `"+i+"` supplied to "+("`"+r+"`."))}if(!Array.isArray(e))return r.thatReturnsNull;for(var t=0;t<e.length;t++){var o=e[t];if("function"!=typeof o)return i(!1,"Invalid argument supplid to oneOfType. Expected an array of check functions, but received %s at index %s.",O(o),t),r.thatReturnsNull}return c(n)}function b(){function e(e,n,t,r,o){return k(e[n])?null:new p("Invalid "+r+" `"+o+"` supplied to "+("`"+t+"`, expected a ReactNode."))}return c(e)}function m(e){function n(n,t,r,o,i){var s=n[t],u=M(s);if("object"!==u)return new p("Invalid "+o+" `"+i+"` of type `"+u+"` "+("supplied to `"+r+"`, expected `object`."));for(var c in e){var f=e[c];if(f){var l=f(s,c,r,o,i+"."+c,a);if(l)return l}}return null}return c(n)}function k(n){switch(typeof n){case"number":case"string":case"undefined":return!0;case"boolean":return!n;case"object":if(Array.isArray(n))return n.every(k);if(null===n||e(n))return!0;var r=t(n);if(!r)return!1;var o,i=r.call(n);if(r!==n.entries){for(;!(o=i.next()).done;)if(!k(o.value))return!1}else for(;!(o=i.next()).done;){var a=o.value;if(a&&!k(a[1]))return!1}return!0;default:return!1}}function P(e,n){return"symbol"===e||("Symbol"===n["@@toStringTag"]||"function"==typeof Symbol&&n instanceof Symbol)}function M(e){var n=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":P(n,e)?"symbol":n}function W(e){if("undefined"==typeof e||null===e)return""+e;var n=M(e);if("object"===n){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return n}function O(e){var n=W(e);switch(n){case"array":case"object":return"an "+n;case"boolean":case"date":case"regexp":return"a "+n;default:return n}}function T(e){return e.constructor&&e.constructor.name?e.constructor.name:A}var x="function"==typeof Symbol&&Symbol.iterator,j="@@iterator",A="<<anonymous>>",L={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:l(),arrayOf:y,element:d(),instanceOf:v,node:b(),objectOf:g,oneOf:h,oneOfType:w,shape:m};return p.prototype=Error.prototype,L.checkPropTypes=s,L.PropTypes=L,L}},{"./checkPropTypes":4,"./lib/ReactPropTypesSecret":8,"fbjs/lib/emptyFunction":1,"fbjs/lib/invariant":2,"fbjs/lib/warning":3}],7:[function(e,n,t){n.exports=e("./factoryWithThrowingShims")()},{"./factoryWithThrowingShims":5,"./factoryWithTypeCheckers":6}],8:[function(e,n,t){"use strict";var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";n.exports=r},{}],9:[function(e,n,t){(function(r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}function a(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function s(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},p=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),c=function(e,n,t){for(var r=!0;r;){var o=e,i=n,a=t;r=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,i);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(a)}var p=Object.getPrototypeOf(o);if(null===p)return;e=p,n=i,t=a,r=!0,s=p=void 0}},f="undefined"!=typeof window?window.React:"undefined"!=typeof r?r.React:null,l=o(f),y=e("prop-types"),d=o(y),v=e("react-leaflet"),h=e("./icons"),g=e("./utils"),w=function(e){function n(e,t){a(this,n),c(Object.getPrototypeOf(n.prototype),"constructor",this).call(this,e,t),this.map=t.map,this.onMapMouseMove=this.onMapMouseMove.bind(this),this.removeNewWaypointMarker=this.removeNewWaypointMarker.bind(this),this.onPreviewMarkerDragStart=this.onPreviewMarkerDragStart.bind(this),this.onPreviewMarkerDragEnd=this.onPreviewMarkerDragEnd.bind(this),this.onNewWaypointMarkerDragEnd=this.onNewWaypointMarkerDragEnd.bind(this),this.onWaypointClick=this.onWaypointClick.bind(this),this.onWaypointDragEnd=this.onWaypointDragEnd.bind(this),this.onPolylineClick=this.onPolylineClick.bind(this),this.hidePreview=this.hidePreview.bind(this),this.showPreview=this.showPreview.bind(this)}return s(n,e),p(n,[{key:"componentWillMount",value:function(){this.map.on("mousemove",this.onMapMouseMove)}},{key:"componentWillUnMount",value:function(){this.map.off("mousemove",this.onMapMouseMove)}},{key:"onMapMouseMove",value:function(e){var n=this.map;if(this.props.positions&&!this.previewHidden){if(!this.onPreviewDrag){var t=(0,g.snapToPolyline)((0,g.toArrayLatLng)(e.latlng),this.props.positions),r=n.latLngToContainerPoint((0,g.toObjLatLng)(t));r.distanceTo(e.containerPoint)>10?this.removePreviewMarker():this.previewMarker?this.previewMarker.setLatLng(t):this.addPreviewMarker(t)}}else this.removePreviewMarker()}},{key:"addPreviewMarker",value:function(e){var n=this;clearTimeout(this.previewTimeout),this.previewTimeout=setTimeout(function(){n.previewMarker=L.marker(e,{icon:n.props.mouseOverWaypointIcon||h.mouseOverWaypointIcon,draggable:!0}).on("dragstart",n.onPreviewMarkerDragStart).on("dragend",n.onPreviewMarkerDragEnd).addTo(n.map)},5)}},{key:"removePreviewMarker",value:function(){this.previewMarker&&(this.map.removeLayer(this.previewMarker),delete this.previewMarker)}},{key:"addNewWaypointMarker",value:function(e){var n=this;this.removeNewWaypointMarker(),clearTimeout(this.newWaypointTimeout),this.newWaypointTimeout=setTimeout(function(){n.newWaypointMarker=L.marker(e,{icon:n.props.draggableWaypointIcon||h.draggableWaypointIcon,draggable:!0,zIndexOffset:50}).on("click",n.removeNewWaypointMarker).on("dragend",n.onNewWaypointMarkerDragEnd).on("mouseover",n.hidePreview).on("mouseout",n.showPreview).addTo(n.map)},5)}},{key:"removeNewWaypointMarker",value:function(){this.newWaypointMarker&&(this.map.removeLayer(this.newWaypointMarker),delete this.newWaypointMarker)}},{key:"onPreviewMarkerDragStart",value:function(e){this.onPreviewDrag=!0}},{key:"onPreviewMarkerDragEnd",value:function(e){this.onPreviewDrag=!1;var n=(0,g.toArrayLatLng)(e.target.getLatLng());if(this.removePreviewMarker(),this.props.onWaypointsChange){var t=[].concat(i(this.props.waypoints),[n]);this.props.onWaypointsChange(t,t.length-1)}this.props.onWaypointAdd&&this.props.onWaypointAdd(n)}},{key:"onNewWaypointMarkerDragEnd",value:function(e){var n=(0,g.toArrayLatLng)(e.target.getLatLng());if(this.removeNewWaypointMarker(),this.props.onWaypointsChange){var t=[].concat(i(this.props.waypoints),[n]);this.props.onWaypointsChange(t,t.length-1)}this.props.onWaypointAdd&&this.props.onWaypointAdd(n)}},{key:"onWaypointClick",value:function(e){this.showPreview(),this.removeNewWaypointMarker();var n=e.target.options.options.index;if(this.props.onWaypointRemove){var t=this.props.waypoints[n];this.props.onWaypointRemove(t,n)}if(this.props.onWaypointsChange){var r=this.props.waypoints.filter(function(e,t){return t!==n});this.props.onWaypointsChange(r)}}},{key:"onWaypointDragEnd",value:function(e){var n=e.target.options.options.index,t=(0,g.toArrayLatLng)(e.target.getLatLng());if(this.removePreviewMarker(),this.props.onWaypointMove&&this.props.onWaypointMove(t,n),this.props.onWaypointsChange){var r=this.props.waypoints.map(function(e,r){return r===n?t:e});this.props.onWaypointsChange(r,n)}}},{key:"onPolylineClick",value:function(e){this.addNewWaypointMarker((0,g.snapToPolyline)((0,g.toArrayLatLng)(e.latlng),this.props.positions)),this.props.onclick&&this.props.onclick()}},{key:"hidePreview",value:function(){this.previewHidden=!0}},{key:"showPreview",value:function(){this.previewHidden=!1}},{key:"render",value:function(){var e=this,n=this.props.waypoints,t=(0,g.objectWithoutProperties)(this.props,b);return l["default"].createElement("g",null,l["default"].createElement(v.Polyline,u({},t,{onclick:this.onPolylineClick})),n.map(function(n,t){return l["default"].createElement(v.Marker,{key:t,position:n,icon:e.props.draggableWaypointIcon||h.draggableWaypointIcon,draggable:!0,ondragend:e.onWaypointDragEnd,onclick:e.onWaypointClick,onmouseover:e.hidePreview,onmouseout:e.showPreview,zIndexOffset:50,options:{index:t}})}))}}]),n}(f.Component),b=["waypoints","onWaypointsChange","onWaypointRemove","onWaypointAdd","onWaypointMove","mouseOverWaypointIcon","draggableWaypointIcon"];w.contextTypes={map:d["default"].object.isRequired},w.propTypes={draggableWaypointIcon:d["default"].object,mouseOverWaypointIcon:d["default"].object,onWaypointAdd:d["default"].func,onWaypointMove:d["default"].func,onWaypointRemove:d["default"].func,onWaypointsChange:d["default"].func,onclick:d["default"].func,positions:d["default"].arrayOf(d["default"].arrayOf(d["default"].number)).isRequired,waypoints:d["default"].arrayOf(d["default"].arrayOf(d["default"].number))},w.defaultProps={waypoints:[],weight:10},t["default"]=w,n.exports=t["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./icons":10,"./utils":11,"prop-types":7,"react-leaflet":void 0}],10:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=L.divIcon({iconSize:[20,20],iconAnchor:[10,10],className:"",html:"<svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid'>\n\t\t\t<circle cx='50' cy='50' r='40' fill='white' stroke='rgba(0,0,0,0.7)' stroke-width='10'></circle>\n\t\t</svg>"});t.mouseOverWaypointIcon=r;var o=L.divIcon({iconSize:[30,30],iconAnchor:[15,15],className:"",html:"<svg width='100%' height='100%' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' preserveAspectRatio='xMidYMid'>\n\t\t\t<circle cx='50' cy='50' r='40' fill='white' stroke='rgba(0,0,0,0.7)' stroke-width='10'></circle>\n\t\t</svg>"});t.draggableWaypointIcon=o},{}],11:[function(e,n,t){"use strict";function r(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,n){var t=n.map(e);return n[t.indexOf(Math.min.apply(Math,r(t)))]},i=function(e){return e*e},a=function(e,n){return i(e[0]-n[0])+i(e[1]-n[1])},s=function(e,n,t){var r=a(n,t);if(0===r)return n;var o=((e[0]-n[0])*(t[0]-n[0])+(e[1]-n[1])*(t[1]-n[1]))/r;return o<0?n:o>1?t:[n[0]+o*(t[0]-n[0]),n[1]+o*(t[1]-n[1])]},u=function(e,n){for(var t=Number.MAX_VALUE,r=0,i=0;i<n.length;++i){var u=a(e,n[i]);u<t&&(t=u,r=i)}var p=n[r];return o(function(n){return a(e,n)},[r-1,r+1].map(function(e){return n[e]}).filter(function(e){return void 0!==e}).map(function(n){return s(e,p,n)}))};t.snapToPolyline=u;var p=function(e){return[e.lat,e.lng]};t.toArrayLatLng=p;var c=function(e){return L.latLng(e[0],e[1])};t.toObjLatLng=c;var f=function(e,n){var t={};for(var r in e)if(e.hasOwnProperty(r)){if(n.indexOf(r)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,r))continue;t[r]=e[r]}return t};t.objectWithoutProperties=f},{}]},{},[9])(9)});